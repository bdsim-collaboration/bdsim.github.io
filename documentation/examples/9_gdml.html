<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GDML &mdash; BDSIM 1.7.7.develop documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=106dc6df"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multiple Beam Lines" href="10_multiple_beamlines.html" />
    <link rel="prev" title="Curvilinear Coordinates" href="6_curvilinear.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BDSIM
              <img src="../_static/bdsim-logo-small.jpg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.7.7.develop
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../licence.html">Licence &amp; Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authorship.html">Authorship</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running.html">Running BDSIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_syntax.html">Input Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_construction.html">Model Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_control.html">Model Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_customisation.html">Model Customisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_conversion.html">Model Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../externalgeometry.html">External Geometry Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output_analysis.html">Output Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_utilities.html">Python Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualisation.html">Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interfacing.html">Interfacing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples &amp; Tests</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples.html#basic-examples">Basic Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#worked-examples">Worked Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#specific-machines">Specific Machines</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html#features">Features</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="features.html">Features</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="fields.html">Fields</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../history.html">Version History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_description.html">Model Description</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BDSIM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../examples.html">Examples &amp; Tests</a></li>
          <li class="breadcrumb-item"><a href="features.html">Features</a></li>
          <li class="breadcrumb-item"><a href="geometry.html">Geometry</a></li>
      <li class="breadcrumb-item active">GDML</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/9_gdml.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gdml">
<h1>GDML<a class="headerlink" href="#gdml" title="Link to this heading"></a></h1>
<section id="magnet-outer-gmad">
<h2>01_magnet_outer.gmad<a class="headerlink" href="#magnet-outer-gmad" title="Link to this heading"></a></h2>
<p>A quadrupole flanked by two drifts. The outer geomtery of the quadrupole
uses a gdml file of a Hitachi magnet at the ATF2.</p>
<p>How to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bdsim</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="mi">01</span><span class="n">_magnet_outer</span><span class="o">.</span><span class="n">gmad</span>
</pre></div>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/01_magnet_outer.png"><img alt="../_images/01_magnet_outer.png" src="../_images/01_magnet_outer.png" style="width: 40%;" /></a>
</figure>
</section>
<section id="placement-gmad">
<h2>02_placement.gmad<a class="headerlink" href="#placement-gmad" title="Link to this heading"></a></h2>
<p>A placement of a piece of geometry (in GDML format) into the world
in an arbitrary location with respect to the coordinate system
origin and not the beam line.</p>
<p>How to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bdsim</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="mi">02</span><span class="n">_placement</span><span class="o">.</span><span class="n">gmad</span>
</pre></div>
</div>
</section>
<section id="twogdmls-gmad">
<h2>03_twogdmls.gmad<a class="headerlink" href="#twogdmls-gmad" title="Link to this heading"></a></h2>
<p>Example of using two different GDML files that contain objects of
the same name. The Geant4 GDML loader would normally not load these
correctly and use the already loaded geometry. BDSIM corrects this
behaviour.</p>
<p>How to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bdsim</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="mi">03</span><span class="n">_twogdmls</span><span class="o">.</span><span class="n">gmad</span>
</pre></div>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/03_twogdmls.png"><img alt="../_images/03_twogdmls.png" src="../_images/03_twogdmls.png" style="width: 60%;" /></a>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Two shapes are visible alongside a beam pipe - a cuboid and
a sphere.</p>
</div>
</section>
<section id="stripoutervolume-gmad">
<h2>13_stripoutervolume.gmad<a class="headerlink" href="#stripoutervolume-gmad" title="Link to this heading"></a></h2>
<p>Example of stripping the outer volume from a loaded piece of geometry. Firstly,
a piece of geometry is created in a Python script using pyg4ometry. This can be
seen below.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/ln-geometry.png"><img alt="../_images/ln-geometry.png" src="../_images/ln-geometry.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-text">VTK visualisation in pyg4ometry of example geometry. Extruded solids
with the outline to make the letters L N.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This script can be run with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipython</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">makeLNGeometry</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">makeLNGeometry</span><span class="o">.</span><span class="n">MakeLNGeometry</span><span class="p">()</span>
</pre></div>
</div>
<p>The visualiser will start. Close it to finish the script. This writes a file called
<code class="code docutils literal notranslate"><span class="pre">ln.gdml</span></code>.</p>
<p>A small model is provided in the file <code class="code docutils literal notranslate"><span class="pre">13_stripoutervolume.gmad</span></code> that places
this geometry twice. Firstly, with just an offset horizontally away from the beam line
and secondly, with an offset along Z only. This second placement would normally overlap
with the beam line, which in this case is a straight line of beam pipes. In the visualisation
above, we do not see the outermost volume, which is actually made of iron (very slightly visible
in light-grey wire-frame lines). In BDSIM, the outermost volume isn’t made transparent and is
visualised, appearing dark red (for iron).</p>
<p>So, to prevent the overlap, we strip off the outer volume for the second placement by setting
the parameter <code class="code docutils literal notranslate"><span class="pre">stripOuterVolume=1;</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lnpv</span><span class="p">:</span> <span class="n">placement</span><span class="p">,</span> <span class="n">geometryFile</span><span class="o">=</span><span class="s2">&quot;gdml:ln.gdml&quot;</span><span class="p">,</span>
                 <span class="n">z</span><span class="o">=</span><span class="mf">1.5</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="n">axisY</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axisAngle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">angle</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">stripOuterVolume</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
<p>Normally, we would prepare some geometry such as shielding with a box of air as the ‘world’
volume for that file, but here we use iron to make a point and so it doesn’t appear transparent.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/13_stripoutervolume.png"><img alt="../_images/13_stripoutervolume.png" src="../_images/13_stripoutervolume.png" style="width: 100%;" /></a>
</figure>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="6_curvilinear.html" class="btn btn-neutral float-left" title="Curvilinear Coordinates" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="10_multiple_beamlines.html" class="btn btn-neutral float-right" title="Multiple Beam Lines" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Beam Delivery Simulation (BDSIM) Copyright (c) Royal Holloway, University of London, 2001 - 2025.
      <span class="lastupdated">Last updated on Jun 13, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JYMKZHVZJ2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-JYMKZHVZJ2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>