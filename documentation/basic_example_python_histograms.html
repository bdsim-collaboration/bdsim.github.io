<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Histograms in Python &mdash; BDSIM 1.7.7.develop documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=106dc6df"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Analysis of Thin Target Products" href="worked_example_target/worked_example_target.html" />
    <link rel="prev" title="Target" href="examples/target-simple.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            BDSIM
              <img src="_static/bdsim-logo-small.jpg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.7.7.develop
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence &amp; Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="authorship.html">Authorship</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running BDSIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_syntax.html">Input Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_construction.html">Model Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_control.html">Model Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_customisation.html">Model Customisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_conversion.html">Model Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="externalgeometry.html">External Geometry Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_analysis.html">Output Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_utilities.html">Python Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfacing.html">Interfacing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples &amp; Tests</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="examples.html#basic-examples">Basic Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="examples/airwatertarget.html">Air Water Target</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/beamLoss.html">Beam Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/beamDump.html">Beam Dump</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/collimation-simple.html">Collimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/simpleMachine.html">Simple Machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/model-model.html">Model-Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/target-simple.html">Target</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Histograms in Python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#topics-covered">Topics Covered</a></li>
<li class="toctree-l4"><a class="reference internal" href="#contents">Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preparation">Preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-histograms">Output Histograms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-histograms">Loading Histograms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plotting-histograms">Plotting Histograms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-histograms">Adding Histograms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiplying-a-histogram">Multiplying a Histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="#root-histogram-operations">ROOT Histogram Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#weighted-sum-of-histograms">Weighted Sum Of Histograms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#worked-examples">Worked Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#specific-machines">Specific Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#features">Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="history.html">Version History</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_description.html">Model Description</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BDSIM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="examples.html">Examples &amp; Tests</a></li>
      <li class="breadcrumb-item active">Histograms in Python</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/basic_example_python_histograms.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="histograms-in-python">
<h1>Histograms in Python<a class="headerlink" href="#histograms-in-python" title="Link to this heading"></a></h1>
<section id="topics-covered">
<h2>Topics Covered<a class="headerlink" href="#topics-covered" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>TH1 histograms in Python</p></li>
<li><p>pybdsim histograms in Python</p></li>
<li><p>Weighted combinations of histograms</p></li>
<li><p>Based on example data files in <code class="code docutils literal notranslate"><span class="pre">bdsim/examples/features/data</span></code>.</p></li>
</ul>
</section>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#preparation">Preparation</a></p></li>
<li><p><a class="reference internal" href="#output-histograms">Output Histograms</a></p></li>
<li><p><a class="reference internal" href="#loading-histograms">Loading Histograms</a></p></li>
<li><p><a class="reference internal" href="#plotting-histograms">Plotting Histograms</a></p></li>
<li><p><a class="reference internal" href="#adding-histograms">Adding Histograms</a></p></li>
<li><p><a class="reference internal" href="#multiplying-a-histogram">Multiplying a Histogram</a></p></li>
<li><p><a class="reference internal" href="#root-histogram-operations">ROOT Histogram Operations</a></p></li>
<li><p><a class="reference internal" href="#weighted-sum-of-histograms">Weighted Sum Of Histograms</a></p></li>
</ul>
</section>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>BDSIM has been compiled and installed.</p></li>
<li><p>The (DY)LD_LIBRARY_PATH and ROOT_INCLUDE_PATH environmental variables are set as
described in <a class="reference internal" href="output_analysis.html#output-analysis-setup"><span class="std std-ref">Setup</span></a>.</p></li>
<li><p>ROOT can be imported in Python</p></li>
<li><p><cite>pybdsim</cite> has been installed.</p></li>
</ul>
<p>IPython is preferred to work interactively with Python. Using this any function
or class can be queried to see how to use it. Therefore, we can explore with
tab complete and use of the question mark.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ipython
&gt;&gt;&gt; import pybdsim
&gt;&gt;&gt; pybdsim.
           pybdsim.Beam            pybdsim.Convert         pybdsim.ModelProcessing
           pybdsim.Builder         pybdsim.Data            pybdsim.Options
           pybdsim.Compare         pybdsim.Field           pybdsim.Plot            &gt;
           pybdsim.Constants       pybdsim.Gmad            pybdsim.Run
&gt;&gt;&gt; pybdsim.Data.TH1?
Init signature: pybdsim.Data.TH1(hist, extractData=True)
Docstring:
Wrapper for a ROOT TH1 instance. Converts to numpy data.

&gt;&gt;&gt; h = file.Get(&quot;histogramName&quot;)
&gt;&gt;&gt; hpy = TH1(h)
File:           ~/physics/reps/pybdsim/pybdsim/Data.py
Type:           type
Subclasses:     TH2
</pre></div>
</div>
</section>
<section id="output-histograms">
<h2>Output Histograms<a class="headerlink" href="#output-histograms" title="Link to this heading"></a></h2>
<p>Histograms can be produced ‘online’ by BDSIM during a simulation (e.g energy loss),
by rebdsim from analysing raw output, or indepently using ROOT. Ultimately, we assume
for this tutorial we have a ROOT histogram (TH1, TH2, TH3 classes) in a ROOT file.</p>
<p>ROOT histograms, once loaded, can be plotted easily with ROOT, however, a common
package is matplotlib in Python to make more modern plots. ROOT histograms cannot
be easily plotted using matplotlib without either writing some code to get the
necessary information or by using some software package.</p>
<p>pybdsim provides some simple classes that can be used to get the information
from a ROOT histogram into that class, which has numpy arrays. It is worth
noting though that ROOT histograms have some very nice functionality that
can be used before plotting.</p>
</section>
<section id="loading-histograms">
<h2>Loading Histograms<a class="headerlink" href="#loading-histograms" title="Link to this heading"></a></h2>
<section id="pybdsim">
<h3>pybdsim<a class="headerlink" href="#pybdsim" title="Link to this heading"></a></h3>
<p>We recommend using pybdsim for this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipython</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pybdsim</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">pybdsim</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;bdsim/examples/features/data/combined-ana.root&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, <code class="code docutils literal notranslate"><span class="pre">d</span></code> is an instance of a pybdsim class that holds the data. The Load
function returns different types depending on whether a raw BDSIM file is loaded
or a rebdsim histogram file is loaded. We can look inside at the histograms by
typing <code class="code docutils literal notranslate"><span class="pre">d.histograms</span></code> and pressing the TAB key (in IPython only).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">histograms</span>
<span class="go">                   d.histograms     d.histograms2d   d.histograms3dpy</span>
<span class="go">                   d.histograms1d   d.histograms2dpy d.histogramspy</span>
<span class="go">                   d.histograms1dpy d.histograms3d</span>
</pre></div>
</div>
<p>Each of these objects is a dictionary (or ‘map’) from a string to a histogram.
The string is the path of the histogram inside the file. We can have a look
by simply typing <code class="code docutils literal notranslate"><span class="pre">d.histogram</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">histograms</span>
<span class="go">{&#39;Event/PerEntryHistograms/PrimaryX&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb4566d69c0&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/EventDuration&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb44cb98810&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/EnergySpectrum&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb44cb98fd0&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/EnergyLossManual&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb44cb999b0&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/TunnelLossManual&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb44cb9a360&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/AperImpactXInRange&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb44cb9ac60&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/PrimaryXY&#39;: &lt;cppyy.gbl.TH2D object at 0x7fb44e8c2800&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/D2XYEnergy&#39;: &lt;cppyy.gbl.TH3D object at 0x7fb44e8c4e00&gt;,</span>
<span class="go"> &#39;Event/SimpleHistograms/PrimaryYSimple&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a19c50&gt;,</span>
<span class="go"> &#39;Event/SimpleHistograms/PrimaryXYSimple&#39;: &lt;cppyy.gbl.TH2D object at 0x7fb44b11fe00&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PhitsHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1b920&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PlossHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1c120&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/ElossHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1c6c0&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PhitsPEHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1d0b0&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PlossPEHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1d970&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/ElossPEHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1e390&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PFirstAIHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1e780&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/ElossTunnelHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1ee30&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/ElossTunnelPEHisto&#39;: &lt;cppyy.gbl.TH1D object at 0x7fb459a1f4d0&gt;}</span>
</pre></div>
</div>
<p>Here, we have loaded the example file <code class="code docutils literal notranslate"><span class="pre">bdsim/examples/features/data/combined-ana.root</span></code>,
which is the sum of two analysis files of 10 events each.</p>
<p>We see the path of the file for each entry in the dictionary and the the ‘value’ is
a ROOT histogram object through ROOT’s Python interface.</p>
<p>pybdsim also provides a python version of each of these in similar dictionaries, but
with the suffix “py”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">histogramspy</span>
<span class="go">{&#39;Event/PerEntryHistograms/PrimaryX&#39;: &lt;pybdsim.Data.TH1 at 0x15cb04e20&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/EventDuration&#39;: &lt;pybdsim.Data.TH1 at 0x15cb04d60&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/EnergySpectrum&#39;: &lt;pybdsim.Data.TH1 at 0x15cb170d0&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/EnergyLossManual&#39;: &lt;pybdsim.Data.TH1 at 0x15cb180a0&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/TunnelLossManual&#39;: &lt;pybdsim.Data.TH1 at 0x15cb180d0&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/AperImpactXInRange&#39;: &lt;pybdsim.Data.TH1 at 0x15cb18100&gt;,</span>
<span class="go"> &#39;Event/SimpleHistograms/PrimaryYSimple&#39;: &lt;pybdsim.Data.TH1 at 0x15cb18130&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PhitsHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb18160&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PlossHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb18190&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/ElossHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb181c0&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PhitsPEHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb181f0&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PlossPEHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb18220&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/ElossPEHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb18250&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/PFirstAIHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb18280&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/ElossTunnelHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb182b0&gt;,</span>
<span class="go"> &#39;Event/MergedHistograms/ElossTunnelPEHisto&#39;: &lt;pybdsim.Data.TH1 at 0x15cb182e0&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/PrimaryXY&#39;: &lt;pybdsim.Data.TH2 at 0x15cb18310&gt;,</span>
<span class="go"> &#39;Event/SimpleHistograms/PrimaryXYSimple&#39;: &lt;pybdsim.Data.TH2 at 0x15cb18340&gt;,</span>
<span class="go"> &#39;Event/PerEntryHistograms/D2XYEnergy&#39;: &lt;pybdsim.Data.TH3 at 0x15cb18370&gt;}</span>
</pre></div>
</div>
<p>Here, all the names are the same but we can see the objects are instances of pybdsim
classes.</p>
<p>This is the full set of histograms. For convenience, the same histograms are also included
in a dictionary for each dimensionality.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Dictionary Name</strong></p></th>
<th class="head"><p><strong>Contents</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>histograms</p></td>
<td><p>ROOT instances of all histograms</p></td>
</tr>
<tr class="row-odd"><td><p>histogramspy</p></td>
<td><p>pybdsim instances of all histograms</p></td>
</tr>
<tr class="row-even"><td><p>histograms1d</p></td>
<td><p>ROOT instances of all 1D histograms</p></td>
</tr>
<tr class="row-odd"><td><p>histograms1dpy</p></td>
<td><p>pybdsim instances of all 1D histograms</p></td>
</tr>
<tr class="row-even"><td><p>histograms2d</p></td>
<td><p>ROOT instances of all 2D histograms</p></td>
</tr>
<tr class="row-odd"><td><p>histograms2dpy</p></td>
<td><p>pybdsim instances of all 2D histograms</p></td>
</tr>
<tr class="row-even"><td><p>histograms3d</p></td>
<td><p>ROOT instances of all 3D histograms</p></td>
</tr>
<tr class="row-odd"><td><p>histograms3dpy</p></td>
<td><p>pybdsim instances of all 3D histograms</p></td>
</tr>
</tbody>
</table>
<p>Each histogram can be accessed from the dictionary by its name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">histograms</span><span class="p">[</span><span class="s1">&#39;Event/PerEntryHistograms/PrimaryX&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The pybdsim ones contain numpy arrays and only Python types.</p>
</section>
<section id="root">
<h3>ROOT<a class="headerlink" href="#root" title="Link to this heading"></a></h3>
<p>In Python, we can also load ROOT histograms using ROOT’s Python interface.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipython</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ROOT</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">ROOT</span><span class="o">.</span><span class="n">TFile</span><span class="p">(</span><span class="s2">&quot;bdsim/examples/features/data/combined-ana.root&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s2">&quot;&#39;Event/PerEntryHistograms/PrimaryX&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="plotting-histograms">
<h2>Plotting Histograms<a class="headerlink" href="#plotting-histograms" title="Link to this heading"></a></h2>
<p>pybdsim provides severl plotting functions for pybdsim histograms for convenience. The
user may of course, write their own in Python or ROOT.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipython</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pybdsim</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">pybdsim</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;bdsim/examples/features/data/cmobined-ana.root&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">histogramspy</span><span class="p">[</span><span class="s1">&#39;Event/PerEntryHistograms/PrimaryX&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pybdsim</span><span class="o">.</span><span class="n">Plot</span><span class="o">.</span><span class="n">Histogram1D</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<p>Several functions are available:</p>
<ul class="simple">
<li><p>Histogram1D</p></li>
<li><p>Histogram1DMultiple</p></li>
<li><p>Histogram2D</p></li>
<li><p>Histogram2DErrors</p></li>
</ul>
<p>See the pybdsim documentation: <a class="reference internal" href="python_utilities.html#python-utilities-documentation"><span class="std std-ref">Documentation</span></a>.</p>
</section>
<section id="adding-histograms">
<h2>Adding Histograms<a class="headerlink" href="#adding-histograms" title="Link to this heading"></a></h2>
<p>To add histograms, it is recommended to use the ROOT version of them in Python, then
convert to a pybdsim one for plotting.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipython</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pybdsim</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">pybdsim</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;bdsim/examples/features/data/ana1.root&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">pybdsim</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;bdsim/examples/features/data/ana1.root&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h1</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">histograms</span><span class="p">[</span><span class="s1">&#39;Event/PerEntryHistograms/PrimaryX&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">histograms</span><span class="p">[</span><span class="s1">&#39;Event/PerEntryHistograms/PrimaryX&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">htotal</span> <span class="o">=</span> <span class="n">h1</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span>
</pre></div>
</div>
<p>Note, this will also calculate the errors correctly (even if there are different numbers of
events in each histogram).</p>
</section>
<section id="multiplying-a-histogram">
<h2>Multiplying a Histogram<a class="headerlink" href="#multiplying-a-histogram" title="Link to this heading"></a></h2>
<p>Multiplication in ROOT is called “scale”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipython</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pybdsim</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">pybdsim</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;bdsim/examples/features/data/ana1.root&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d1</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="root-histogram-operations">
<h2>ROOT Histogram Operations<a class="headerlink" href="#root-histogram-operations" title="Link to this heading"></a></h2>
<p>Some useful functions in a TH1 in ROOT:</p>
<ul class="simple">
<li><p>h.Add(otherHistogram) - add two histograms</p></li>
<li><p>h.Scale(number) - multiply by a number</p></li>
<li><p>h.Divide(otherHistogram) - the ratio of two histograms</p></li>
<li><p>h.Integral()</p></li>
</ul>
<p>ROOT has extensive documentation on the histograms: <a class="reference external" href="https://root.cern.ch/doc/master/classTH1.html#normalizing">https://root.cern.ch/doc/master/classTH1.html#normalizing</a> .</p>
</section>
<section id="weighted-sum-of-histograms">
<h2>Weighted Sum Of Histograms<a class="headerlink" href="#weighted-sum-of-histograms" title="Link to this heading"></a></h2>
<p>To make a weighted sum of histograms we can use combinations of the above methods. We assume
each histogram has the same shape (i.e. number of dimension and also number of bins and ranges).</p>
<p>If we know all histograms are the same, then we should copy (“clone”) the first one and empty it,
then add each to that one.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">histograms</span> <span class="o">=</span> <span class="p">[</span><span class="n">h1</span><span class="p">,</span><span class="n">h2</span><span class="p">,</span><span class="n">h3</span><span class="p">,</span><span class="n">h4</span><span class="p">]</span>  <span class="c1"># list of ROOT histograms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span>    <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">htotal</span> <span class="o">=</span> <span class="n">histograms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Clone</span><span class="p">()</span><span class="o">.</span><span class="n">Reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">histograms</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
<span class="go">        htotal.Add(h,w)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">htotalpy</span> <span class="o">=</span> <span class="n">pybdsim</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">TH1</span><span class="p">(</span><span class="n">htotal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pybdsim</span><span class="o">.</span><span class="n">Plot</span><span class="o">.</span><span class="n">Histogram1D</span><span class="p">(</span><span class="n">htotalpy</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples/target-simple.html" class="btn btn-neutral float-left" title="Target" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="worked_example_target/worked_example_target.html" class="btn btn-neutral float-right" title="Analysis of Thin Target Products" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Beam Delivery Simulation (BDSIM) Copyright (c) Royal Holloway, University of London, 2001 - 2025.
      <span class="lastupdated">Last updated on Jun 13, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JYMKZHVZJ2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-JYMKZHVZJ2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>